
首页
知乎直答焕新
知乎知学堂
等你来答
​
提问

​8
消息
​
私信
​
创作中心
点击打开欺乘徐的主页
斯坦福AI小镇开源了，流程分析
首发于
软件架构

点击打开欺乘徐的主页
斯坦福AI小镇开源了，流程分析
斯坦福AI小镇开源了，流程分析
真趣
真趣
​关注他
收录于 · LLM + Agent + Game
491 人赞同了该文章
#更新

斯坦福AI小镇流程分析（二）

=================================================

今天突然发现斯坦福的25人小镇模拟开源了，地址 joonspk-research/generative_agents: Generative Agents: Interactive Simulacra of Human Behavior (github.com)

我最近一直在试图根据他们的论文 https://arxiv.org/pdf/2304.03442.pdf 复现，由于之前没有开源代码，只有大概的架构和一些prompt，很多还是靠自己去解决。今天正好开源了，我第一时间clone了工程跑起来看。

按照Readme跑起来没问题，但是我run 100报错list index out of range了，run 10可以。

我本来以为这个模拟是个像游戏一样实时运行的，但实际是先算再走，比如run 10就是模拟10步（每步10秒，就是游戏时间100秒），数据算出来后，浏览器上的客户端使用这些数据跑100秒然后停下。然后你继续命令行run xxx步继续计算。这么搞回避了LLM推理慢的问题，我自己做的demo是实时的，LLM推理一次要花个几秒钟，我还搞了个加速功能（因为不想真的等一天），但游戏时间加速太快可能等不及LLM返回。所以他这个现在跑起来也解决了我的疑惑，我之前还好奇他是怎么克服这个问题的。

另外一个问题是成本，真贵啊，我这100秒的模拟，就花了我9块人民币，如果是模拟游戏中一整天，就是天价了。当然也可能是刚开始LLM的调用次数比较多。

以下是我run 10之后控制台的log输出的分析，可以看到模拟的整个过程。

另外本文不是源码分析，就是分析一下他运行的流程，梳理一下这个架构的逻辑。

生成起床时间
(python3912) G:\ai\generative_agents\reverie\backend_server>python reverie.py
Enter the name of the forked simulation: base_the_ville_isabella_maria_klaus
Enter the name of the new simulation: test-simulation
Note: The agents in this simulation package are computational
constructs powered by generative agents architecture and LLM. We
clarify that these agents lack human-like agency, consciousness,
and independent decision-making.
---
Enter option: run 10
GNS FUNCTION: <generate_wake_up_hour>
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
=== persona/prompt_template/v2/wake_up_hour_v1.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-002', 'max_tokens': 5, 'temperature': 0.8, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': ['\n']}

~~~ prompt_input    ----------------------------------------------
["Name: Isabella Rodriguez\nAge: 34\nInnate traits: friendly, outgoing, hospitable\nLearned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.\nCurrently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.\nLifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.\nDaily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.\nCurrent Date: Monday February 13\n", 'Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.', 'Isabella']

~~~ prompt    ----------------------------------------------------
Name: Isabella Rodriguez
Age: 34
Innate traits: friendly, outgoing, hospitable
Learned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.
Currently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.
Lifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Daily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Current Date: Monday February 13


In general, Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Isabella's wake up hour:

~~~ output    ----------------------------------------------------
8

=== END ==========================================================
第一次LLM调用是为了推理Agent的起床时间，其实仔细看，好像很多输入的信息和起床时间关系不大，并且最后推理出的8，好像也不太对，毕竟8点钟咖啡店就要开门了。这儿我要说两个问题，一是推理结果，不能期望一定是对的，或者说完全符合逻辑的，现阶段的LLM就是这样的，当然这儿为啥用text-davinci-002啊，而不是gpt-3.5-turbo，如果是gpt3.5应该好些，gpt4应该更好吧。我直接clone下来默认配置跑的，可能要修改一下配置。另一个问题是，虽然推理起床时间看上去不需要很多信息，但这儿是使用一个架构去解决问题的，看过论文知道，他这个的核心是记忆流，所以这儿的信息全部是初始信息，如果有记忆，得到的信息就会参考记忆，这儿是一个架构，所以有可能看上去比较多余。

生成第一天的计划
GNS FUNCTION: <generate_first_daily_plan>
=== persona/prompt_template/v2/daily_planning_v6.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 500, 'temperature': 1, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': None}

~~~ prompt_input    ----------------------------------------------
["Name: Isabella Rodriguez\nAge: 34\nInnate traits: friendly, outgoing, hospitable\nLearned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.\nCurrently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.\nLifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.\nDaily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.\nCurrent Date: Monday February 13\n", 'Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.', 'Monday February 13', 'Isabella', '8:00 am']

~~~ prompt    ----------------------------------------------------
Name: Isabella Rodriguez
Age: 34
Innate traits: friendly, outgoing, hospitable
Learned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.
Currently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.
Lifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Daily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Current Date: Monday February 13


In general, Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Today is Monday February 13. Here is Isabella's plan today in broad-strokes (with the time of the day. e.g., have a lunch at 12:00 pm, watch TV from 7 to 8 pm): 1) wake up and complete the morning routine at 8:00 am, 2)

~~~ output    ----------------------------------------------------
['wake up and complete the morning routine at 8:00 am', 'open the cafe at 8:00 am', 'work at the cafe counter until 8 pm', 'close the cafe at 8 pm', 'have dinner at 8:30 pm', 'watch TV from 7 to 8 pm', "do some cleaning up or prepare for the Valentine's Day party"]

=== END ==========================================================
这个和论文上说的一样，生成了一个大概的计划（使用自然语言描述），可能是使用了text-davinci-003的原因，这个计划看上去不是很完美，不过这不影响分析架构流程。

生成按小时的日程表
按小时的日程不是一次生成的（一次LLM调用），而是每个小时都要调用一次LLM生成。生成的时候会把之前已经生成的日程放在prompt中。

首先是8点开始的第一个小时（前面7个小时默认都是在睡觉，因为之前已经生成了8点起床）

GNS FUNCTION: <generate_hourly_schedule>
=== persona/prompt_template/v2/generate_hourly_schedule_v2.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 50, 'temperature': 0.5, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': ['\n']}

~~~ prompt_input    ----------------------------------------------
['[Monday February 13 -- 00:00 AM] Activity: [Fill in]\n[Monday February 13 -- 01:00 AM] Activity: [Fill in]\n[Monday February 13 -- 02:00 AM] Activity: [Fill in]\n[Monday February 13 -- 03:00 AM] Activity: [Fill in]\n[Monday February 13 -- 04:00 AM] Activity: [Fill in]\n[Monday February 13 -- 05:00 AM] Activity: [Fill in]\n[Monday February 13 -- 06:00 AM] Activity: [Fill in]\n[Monday February 13 -- 07:00 AM] Activity: [Fill in]\n[Monday February 13 -- 08:00 AM] Activity: [Fill in]\n[Monday February 13 -- 09:00 AM] Activity: [Fill in]\n[Monday February 13 -- 10:00 AM] Activity: [Fill in]\n[Monday February 13 -- 11:00 AM] Activity: [Fill in]\n[Monday February 13 -- 12:00 PM] Activity: [Fill in]\n[Monday February 13 -- 01:00 PM] Activity: [Fill in]\n[Monday February 13 -- 02:00 PM] Activity: [Fill in]\n[Monday February 13 -- 03:00 PM] Activity: [Fill in]\n[Monday February 13 -- 04:00 PM] Activity: [Fill in]\n[Monday February 13 -- 05:00 PM] Activity: [Fill in]\n[Monday February 13 -- 06:00 PM] Activity: [Fill in]\n[Monday February 13 -- 07:00 PM] Activity: [Fill in]\n[Monday February 13 -- 08:00 PM] Activity: [Fill in]\n[Monday February 13 -- 09:00 PM] Activity: [Fill in]\n[Monday February 13 -- 10:00 PM] Activity: [Fill in]\n[Monday February 13 -- 11:00 PM] Activity: [Fill in]', "Name: Isabella Rodriguez\nAge: 34\nInnate traits: friendly, outgoing, hospitable\nLearned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.\nCurrently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.\nLifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.\nDaily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.\nCurrent Date: Monday February 13\n", '\n[(ID:rrRkle) Monday February 13 -- 00:00 AM] Activity: Isabella is sleeping\n[(ID:UOCrVA) Monday February 13 -- 01:00 AM] Activity: Isabella is sleeping\n[(ID:mGNhv4) Monday February 13 -- 02:00 AM] Activity: Isabella is sleeping\n[(ID:r4cjDu) Monday February 13 -- 03:00 AM] Activity: Isabella is sleeping\n[(ID:RaPnob) Monday February 13 -- 04:00 AM] Activity: Isabella is sleeping\n[(ID:9Gg37a) Monday February 13 -- 05:00 AM] Activity: Isabella is sleeping\n[(ID:AqKaey) Monday February 13 -- 06:00 AM] Activity: Isabella is sleeping\n[(ID:6qeiSf) Monday February 13 -- 07:00 AM] Activity: Isabella is sleeping\n\n', "Here the originally intended hourly breakdown of Isabella's schedule today: 1) wake up and complete the morning routine at 8:00 am, 2) open the cafe at 8:00 am, 3) work at the cafe counter until 8 pm, 4) close the cafe at 8 pm, 5) have dinner at 8:30 pm, 6) watch TV from 7 to 8 pm, 7) do some cleaning up or prepare for the Valentine's Day party", '', '[(ID:0DjmLD) Monday February 13 -- 08:00 AM] Activity: Isabella is']

~~~ prompt    ----------------------------------------------------
Hourly schedule format:
[Monday February 13 -- 00:00 AM] Activity: [Fill in]
[Monday February 13 -- 01:00 AM] Activity: [Fill in]
[Monday February 13 -- 02:00 AM] Activity: [Fill in]
[Monday February 13 -- 03:00 AM] Activity: [Fill in]
[Monday February 13 -- 04:00 AM] Activity: [Fill in]
[Monday February 13 -- 05:00 AM] Activity: [Fill in]
[Monday February 13 -- 06:00 AM] Activity: [Fill in]
[Monday February 13 -- 07:00 AM] Activity: [Fill in]
[Monday February 13 -- 08:00 AM] Activity: [Fill in]
[Monday February 13 -- 09:00 AM] Activity: [Fill in]
[Monday February 13 -- 10:00 AM] Activity: [Fill in]
[Monday February 13 -- 11:00 AM] Activity: [Fill in]
[Monday February 13 -- 12:00 PM] Activity: [Fill in]
[Monday February 13 -- 01:00 PM] Activity: [Fill in]
[Monday February 13 -- 02:00 PM] Activity: [Fill in]
[Monday February 13 -- 03:00 PM] Activity: [Fill in]
[Monday February 13 -- 04:00 PM] Activity: [Fill in]
[Monday February 13 -- 05:00 PM] Activity: [Fill in]
[Monday February 13 -- 06:00 PM] Activity: [Fill in]
[Monday February 13 -- 07:00 PM] Activity: [Fill in]
[Monday February 13 -- 08:00 PM] Activity: [Fill in]
[Monday February 13 -- 09:00 PM] Activity: [Fill in]
[Monday February 13 -- 10:00 PM] Activity: [Fill in]
[Monday February 13 -- 11:00 PM] Activity: [Fill in]
===
Name: Isabella Rodriguez
Age: 34
Innate traits: friendly, outgoing, hospitable
Learned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.
Currently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.
Lifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Daily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Current Date: Monday February 13


[(ID:rrRkle) Monday February 13 -- 00:00 AM] Activity: Isabella is sleeping
[(ID:UOCrVA) Monday February 13 -- 01:00 AM] Activity: Isabella is sleeping
[(ID:mGNhv4) Monday February 13 -- 02:00 AM] Activity: Isabella is sleeping
[(ID:r4cjDu) Monday February 13 -- 03:00 AM] Activity: Isabella is sleeping
[(ID:RaPnob) Monday February 13 -- 04:00 AM] Activity: Isabella is sleeping
[(ID:9Gg37a) Monday February 13 -- 05:00 AM] Activity: Isabella is sleeping
[(ID:AqKaey) Monday February 13 -- 06:00 AM] Activity: Isabella is sleeping
[(ID:6qeiSf) Monday February 13 -- 07:00 AM] Activity: Isabella is sleeping


Here the originally intended hourly breakdown of Isabella's schedule today: 1) wake up and complete the morning routine at 8:00 am, 2) open the cafe at 8:00 am, 3) work at the cafe counter until 8 pm, 4) close the cafe at 8 pm, 5) have dinner at 8:30 pm, 6) watch TV from 7 to 8 pm, 7) do some cleaning up or prepare for the Valentine's Day party
[(ID:0DjmLD) Monday February 13 -- 08:00 AM] Activity: Isabella is

~~~ output    ----------------------------------------------------
waking up and completing her morning routine

=== END ==========================================================
这个prompt中强调了日程的格式，并且不是简单说一下格式是什么，而是直接给出了每个一小时时间段的格式（尽管格式是一样的）。然后同样是给出了角色的信息，当前日期；然后是已经安排好的日程，从0点开始，一直到7点都是睡觉（所以第一步是先确定起床时间）；再然后给出了前面生成的日计划，最后给出8点的日程让LLM填空。LLM的返回非常符合预期，很好。

下面是9点这个时间段的：

=== persona/prompt_template/v2/generate_hourly_schedule_v2.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 50, 'temperature': 0.5, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': ['\n']}

~~~ prompt_input    ----------------------------------------------
['[Monday February 13 -- 00:00 AM] Activity: [Fill in]\n[Monday February 13 -- 01:00 AM] Activity: [Fill in]\n[Monday February 13 -- 02:00 AM] Activity: [Fill in]\n[Monday February 13 -- 03:00 AM] Activity: [Fill in]\n[Monday February 13 -- 04:00 AM] Activity: [Fill in]\n[Monday February 13 -- 05:00 AM] Activity: [Fill in]\n[Monday February 13 -- 06:00 AM] Activity: [Fill in]\n[Monday February 13 -- 07:00 AM] Activity: [Fill in]\n[Monday February 13 -- 08:00 AM] Activity: [Fill in]\n[Monday February 13 -- 09:00 AM] Activity: [Fill in]\n[Monday February 13 -- 10:00 AM] Activity: [Fill in]\n[Monday February 13 -- 11:00 AM] Activity: [Fill in]\n[Monday February 13 -- 12:00 PM] Activity: [Fill in]\n[Monday February 13 -- 01:00 PM] Activity: [Fill in]\n[Monday February 13 -- 02:00 PM] Activity: [Fill in]\n[Monday February 13 -- 03:00 PM] Activity: [Fill in]\n[Monday February 13 -- 04:00 PM] Activity: [Fill in]\n[Monday February 13 -- 05:00 PM] Activity: [Fill in]\n[Monday February 13 -- 06:00 PM] Activity: [Fill in]\n[Monday February 13 -- 07:00 PM] Activity: [Fill in]\n[Monday February 13 -- 08:00 PM] Activity: [Fill in]\n[Monday February 13 -- 09:00 PM] Activity: [Fill in]\n[Monday February 13 -- 10:00 PM] Activity: [Fill in]\n[Monday February 13 -- 11:00 PM] Activity: [Fill in]', "Name: Isabella Rodriguez\nAge: 34\nInnate traits: friendly, outgoing, hospitable\nLearned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.\nCurrently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.\nLifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.\nDaily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.\nCurrent Date: Monday February 13\n", '\n[(ID:IyiKS8) Monday February 13 -- 00:00 AM] Activity: Isabella is sleeping\n[(ID:MQVMiD) Monday February 13 -- 01:00 AM] Activity: Isabella is sleeping\n[(ID:ATGrkG) Monday February 13 -- 02:00 AM] Activity: Isabella is sleeping\n[(ID:b5iRqR) Monday February 13 -- 03:00 AM] Activity: Isabella is sleeping\n[(ID:bw2Pyc) Monday February 13 -- 04:00 AM] Activity: Isabella is sleeping\n[(ID:YjXxXu) Monday February 13 -- 05:00 AM] Activity: Isabella is sleeping\n[(ID:3tegsS) Monday February 13 -- 06:00 AM] Activity: Isabella is sleeping\n[(ID:k4kml3) Monday February 13 -- 07:00 AM] Activity: Isabella is sleeping\n[(ID:IHfCVy) Monday February 13 -- 08:00 AM] Activity: Isabella is waking up and completing her morning routine\n\n', "Here the originally intended hourly breakdown of Isabella's schedule today: 1) wake up and complete the morning routine at 8:00 am, 2) open the cafe at 8:00 am, 3) work at the cafe counter until 8 pm, 4) close the cafe at 8 pm, 5) have dinner at 8:30 pm, 6) watch TV from 7 to 8 pm, 7) do some cleaning up or prepare for the Valentine's Day party", '', '[(ID:1UQ3es) Monday February 13 -- 09:00 AM] Activity: Isabella is']

~~~ prompt    ----------------------------------------------------
Hourly schedule format:
[Monday February 13 -- 00:00 AM] Activity: [Fill in]
[Monday February 13 -- 01:00 AM] Activity: [Fill in]
[Monday February 13 -- 02:00 AM] Activity: [Fill in]
[Monday February 13 -- 03:00 AM] Activity: [Fill in]
[Monday February 13 -- 04:00 AM] Activity: [Fill in]
[Monday February 13 -- 05:00 AM] Activity: [Fill in]
[Monday February 13 -- 06:00 AM] Activity: [Fill in]
[Monday February 13 -- 07:00 AM] Activity: [Fill in]
[Monday February 13 -- 08:00 AM] Activity: [Fill in]
[Monday February 13 -- 09:00 AM] Activity: [Fill in]
[Monday February 13 -- 10:00 AM] Activity: [Fill in]
[Monday February 13 -- 11:00 AM] Activity: [Fill in]
[Monday February 13 -- 12:00 PM] Activity: [Fill in]
[Monday February 13 -- 01:00 PM] Activity: [Fill in]
[Monday February 13 -- 02:00 PM] Activity: [Fill in]
[Monday February 13 -- 03:00 PM] Activity: [Fill in]
[Monday February 13 -- 04:00 PM] Activity: [Fill in]
[Monday February 13 -- 05:00 PM] Activity: [Fill in]
[Monday February 13 -- 06:00 PM] Activity: [Fill in]
[Monday February 13 -- 07:00 PM] Activity: [Fill in]
[Monday February 13 -- 08:00 PM] Activity: [Fill in]
[Monday February 13 -- 09:00 PM] Activity: [Fill in]
[Monday February 13 -- 10:00 PM] Activity: [Fill in]
[Monday February 13 -- 11:00 PM] Activity: [Fill in]
===
Name: Isabella Rodriguez
Age: 34
Innate traits: friendly, outgoing, hospitable
Learned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.
Currently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.
Lifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Daily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Current Date: Monday February 13


[(ID:IyiKS8) Monday February 13 -- 00:00 AM] Activity: Isabella is sleeping
[(ID:MQVMiD) Monday February 13 -- 01:00 AM] Activity: Isabella is sleeping
[(ID:ATGrkG) Monday February 13 -- 02:00 AM] Activity: Isabella is sleeping
[(ID:b5iRqR) Monday February 13 -- 03:00 AM] Activity: Isabella is sleeping
[(ID:bw2Pyc) Monday February 13 -- 04:00 AM] Activity: Isabella is sleeping
[(ID:YjXxXu) Monday February 13 -- 05:00 AM] Activity: Isabella is sleeping
[(ID:3tegsS) Monday February 13 -- 06:00 AM] Activity: Isabella is sleeping
[(ID:k4kml3) Monday February 13 -- 07:00 AM] Activity: Isabella is sleeping
[(ID:IHfCVy) Monday February 13 -- 08:00 AM] Activity: Isabella is waking up and completing her morning routine


Here the originally intended hourly breakdown of Isabella's schedule today: 1) wake up and complete the morning routine at 8:00 am, 2) open the cafe at 8:00 am, 3) work at the cafe counter until 8 pm, 4) close the cafe at 8 pm, 5) have dinner at 8:30 pm, 6) watch TV from 7 to 8 pm, 7) do some cleaning up or prepare for the Valentine's Day party
[(ID:1UQ3es) Monday February 13 -- 09:00 AM] Activity: Isabella is

~~~ output    ----------------------------------------------------
opening Hobbs Cafe

=== END ==========================================================
prompt中给出了0点开始，到8点，每个时间段的日程，其中8点的日程是上一步生成的。最后让LLM填空9点的日程。输出仍然符合预期，咖啡馆开门。（尽管咖啡馆通常是8点开门，但是偶尔起晚了也不是不行：）

下面继续一个小时一个小时安排，直接跳到晚上11点：

=== persona/prompt_template/v2/generate_hourly_schedule_v2.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 50, 'temperature': 0.5, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': ['\n']}

~~~ prompt_input    ----------------------------------------------
['[Monday February 13 -- 00:00 AM] Activity: [Fill in]\n[Monday February 13 -- 01:00 AM] Activity: [Fill in]\n[Monday February 13 -- 02:00 AM] Activity: [Fill in]\n[Monday February 13 -- 03:00 AM] Activity: [Fill in]\n[Monday February 13 -- 04:00 AM] Activity: [Fill in]\n[Monday February 13 -- 05:00 AM] Activity: [Fill in]\n[Monday February 13 -- 06:00 AM] Activity: [Fill in]\n[Monday February 13 -- 07:00 AM] Activity: [Fill in]\n[Monday February 13 -- 08:00 AM] Activity: [Fill in]\n[Monday February 13 -- 09:00 AM] Activity: [Fill in]\n[Monday February 13 -- 10:00 AM] Activity: [Fill in]\n[Monday February 13 -- 11:00 AM] Activity: [Fill in]\n[Monday February 13 -- 12:00 PM] Activity: [Fill in]\n[Monday February 13 -- 01:00 PM] Activity: [Fill in]\n[Monday February 13 -- 02:00 PM] Activity: [Fill in]\n[Monday February 13 -- 03:00 PM] Activity: [Fill in]\n[Monday February 13 -- 04:00 PM] Activity: [Fill in]\n[Monday February 13 -- 05:00 PM] Activity: [Fill in]\n[Monday February 13 -- 06:00 PM] Activity: [Fill in]\n[Monday February 13 -- 07:00 PM] Activity: [Fill in]\n[Monday February 13 -- 08:00 PM] Activity: [Fill in]\n[Monday February 13 -- 09:00 PM] Activity: [Fill in]\n[Monday February 13 -- 10:00 PM] Activity: [Fill in]\n[Monday February 13 -- 11:00 PM] Activity: [Fill in]', "Name: Isabella Rodriguez\nAge: 34\nInnate traits: friendly, outgoing, hospitable\nLearned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.\nCurrently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.\nLifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.\nDaily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.\nCurrent Date: Monday February 13\n", "\n[(ID:VjYTQQ) Monday February 13 -- 00:00 AM] Activity: Isabella is sleeping\n[(ID:EUwkcb) Monday February 13 -- 01:00 AM] Activity: Isabella is sleeping\n[(ID:HR1X5J) Monday February 13 -- 02:00 AM] Activity: Isabella is sleeping\n[(ID:XNvFb7) Monday February 13 -- 03:00 AM] Activity: Isabella is sleeping\n[(ID:R3JKmc) Monday February 13 -- 04:00 AM] Activity: Isabella is sleeping\n[(ID:Xvs7Yv) Monday February 13 -- 05:00 AM] Activity: Isabella is sleeping\n[(ID:pv1fX4) Monday February 13 -- 06:00 AM] Activity: Isabella is sleeping\n[(ID:EjAFIA) Monday February 13 -- 07:00 AM] Activity: Isabella is sleeping\n[(ID:kcxIi7) Monday February 13 -- 08:00 AM] Activity: Isabella is waking up and completing her morning routine\n[(ID:spQHGZ) Monday February 13 -- 09:00 AM] Activity: Isabella is opening Hobbs Cafe\n[(ID:Tj3RrF) Monday February 13 -- 10:00 AM] Activity: Isabella is working at the cafe counter\n[(ID:sT4NDA) Monday February 13 -- 11:00 AM] Activity: Isabella is working at the cafe counter\n[(ID:BKtTx6) Monday February 13 -- 12:00 PM] Activity: Isabella is working at the cafe counter\n[(ID:XcjFpX) Monday February 13 -- 01:00 PM] Activity: Isabella is working at the cafe counter\n[(ID:EUzlHi) Monday February 13 -- 02:00 PM] Activity: Isabella is working at the cafe counter\n[(ID:CBPTyE) Monday February 13 -- 03:00 PM] Activity: Isabella is working at the cafe counter\n[(ID:XGyAL4) Monday February 13 -- 04:00 PM] Activity: Isabella is working at the cafe counter\n[(ID:IWcY8y) Monday February 13 -- 05:00 PM] Activity: Isabella is having dinner\n[(ID:oB4j9H) Monday February 13 -- 06:00 PM] Activity: Isabella is watching TV\n[(ID:OmljGH) Monday February 13 -- 07:00 PM] Activity: Isabella is cleaning up or preparing for the Valentine's Day party\n[(ID:qViSCa) Monday February 13 -- 08:00 PM] Activity: Isabella is closing Hobbs Cafe\n[(ID:J2DPBB) Monday February 13 -- 09:00 PM] Activity: Isabella is watching TV\n[(ID:unJeg8) Monday February 13 -- 10:00 PM] Activity: Isabella is watching TV\n\n", "Here the originally intended hourly breakdown of Isabella's schedule today: 1) wake up and complete the morning routine at 8:00 am, 2) open the cafe at 8:00 am, 3) work at the cafe counter until 8 pm, 4) close the cafe at 8 pm, 5) have dinner at 8:30 pm, 6) watch TV from 7 to 8 pm, 7) do some cleaning up or prepare for the Valentine's Day party", '', '[(ID:WEDwo6) Monday February 13 -- 11:00 PM] Activity: Isabella is']

~~~ prompt    ----------------------------------------------------
Hourly schedule format:
[Monday February 13 -- 00:00 AM] Activity: [Fill in]
[Monday February 13 -- 01:00 AM] Activity: [Fill in]
[Monday February 13 -- 02:00 AM] Activity: [Fill in]
[Monday February 13 -- 03:00 AM] Activity: [Fill in]
[Monday February 13 -- 04:00 AM] Activity: [Fill in]
[Monday February 13 -- 05:00 AM] Activity: [Fill in]
[Monday February 13 -- 06:00 AM] Activity: [Fill in]
[Monday February 13 -- 07:00 AM] Activity: [Fill in]
[Monday February 13 -- 08:00 AM] Activity: [Fill in]
[Monday February 13 -- 09:00 AM] Activity: [Fill in]
[Monday February 13 -- 10:00 AM] Activity: [Fill in]
[Monday February 13 -- 11:00 AM] Activity: [Fill in]
[Monday February 13 -- 12:00 PM] Activity: [Fill in]
[Monday February 13 -- 01:00 PM] Activity: [Fill in]
[Monday February 13 -- 02:00 PM] Activity: [Fill in]
[Monday February 13 -- 03:00 PM] Activity: [Fill in]
[Monday February 13 -- 04:00 PM] Activity: [Fill in]
[Monday February 13 -- 05:00 PM] Activity: [Fill in]
[Monday February 13 -- 06:00 PM] Activity: [Fill in]
[Monday February 13 -- 07:00 PM] Activity: [Fill in]
[Monday February 13 -- 08:00 PM] Activity: [Fill in]
[Monday February 13 -- 09:00 PM] Activity: [Fill in]
[Monday February 13 -- 10:00 PM] Activity: [Fill in]
[Monday February 13 -- 11:00 PM] Activity: [Fill in]
===
Name: Isabella Rodriguez
Age: 34
Innate traits: friendly, outgoing, hospitable
Learned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.
Currently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.
Lifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Daily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Current Date: Monday February 13


[(ID:VjYTQQ) Monday February 13 -- 00:00 AM] Activity: Isabella is sleeping
[(ID:EUwkcb) Monday February 13 -- 01:00 AM] Activity: Isabella is sleeping
[(ID:HR1X5J) Monday February 13 -- 02:00 AM] Activity: Isabella is sleeping
[(ID:XNvFb7) Monday February 13 -- 03:00 AM] Activity: Isabella is sleeping
[(ID:R3JKmc) Monday February 13 -- 04:00 AM] Activity: Isabella is sleeping
[(ID:Xvs7Yv) Monday February 13 -- 05:00 AM] Activity: Isabella is sleeping
[(ID:pv1fX4) Monday February 13 -- 06:00 AM] Activity: Isabella is sleeping
[(ID:EjAFIA) Monday February 13 -- 07:00 AM] Activity: Isabella is sleeping
[(ID:kcxIi7) Monday February 13 -- 08:00 AM] Activity: Isabella is waking up and completing her morning routine
[(ID:spQHGZ) Monday February 13 -- 09:00 AM] Activity: Isabella is opening Hobbs Cafe
[(ID:Tj3RrF) Monday February 13 -- 10:00 AM] Activity: Isabella is working at the cafe counter
[(ID:sT4NDA) Monday February 13 -- 11:00 AM] Activity: Isabella is working at the cafe counter
[(ID:BKtTx6) Monday February 13 -- 12:00 PM] Activity: Isabella is working at the cafe counter
[(ID:XcjFpX) Monday February 13 -- 01:00 PM] Activity: Isabella is working at the cafe counter
[(ID:EUzlHi) Monday February 13 -- 02:00 PM] Activity: Isabella is working at the cafe counter
[(ID:CBPTyE) Monday February 13 -- 03:00 PM] Activity: Isabella is working at the cafe counter
[(ID:XGyAL4) Monday February 13 -- 04:00 PM] Activity: Isabella is working at the cafe counter
[(ID:IWcY8y) Monday February 13 -- 05:00 PM] Activity: Isabella is having dinner
[(ID:oB4j9H) Monday February 13 -- 06:00 PM] Activity: Isabella is watching TV
[(ID:OmljGH) Monday February 13 -- 07:00 PM] Activity: Isabella is cleaning up or preparing for the Valentine's Day party
[(ID:qViSCa) Monday February 13 -- 08:00 PM] Activity: Isabella is closing Hobbs Cafe
[(ID:J2DPBB) Monday February 13 -- 09:00 PM] Activity: Isabella is watching TV
[(ID:unJeg8) Monday February 13 -- 10:00 PM] Activity: Isabella is watching TV


Here the originally intended hourly breakdown of Isabella's schedule today: 1) wake up and complete the morning routine at 8:00 am, 2) open the cafe at 8:00 am, 3) work at the cafe counter until 8 pm, 4) close the cafe at 8 pm, 5) have dinner at 8:30 pm, 6) watch TV from 7 to 8 pm, 7) do some cleaning up or prepare for the Valentine's Day party
[(ID:WEDwo6) Monday February 13 -- 11:00 PM] Activity: Isabella is

~~~ output    ----------------------------------------------------
getting ready for bed

=== END ==========================================================
到11点，生成了睡觉的日程之后，就结束了按小时生成日程的操作。因为11点开始的这个小时就是这一天最后一个小时了。下一步是细化日程。

生成细化任务
应该是使用了task_decomp_v3.txt这个模板

GNS FUNCTION: <generate_task_decomp>
DEBUG
[['sleeping', 480], ['waking up and completing her morning routine', 60], ['opening Hobbs Cafe', 60], ['working at the cafe counter', 420], ['having dinner', 60], ['watching TV', 60], ["cleaning up or preparing for the Valentine's Day party", 60], ['closing Hobbs Cafe', 60], ['watching TV', 120], ['getting ready for bed', 60]]
[0, 1, 2]
index 0
index 1
index 2
?????
Describe subtasks in 5 min increments.
---
Name: Kelly Bronson
Age: 35
Backstory: Kelly always wanted to be a teacher, and now she teaches kindergarten. During the week, she dedicates herself to her students, but on the weekends, she likes to try out new restaurants and hang out with friends. She is very warm and friendly, and loves caring for others.
Personality: sweet, gentle, meticulous
Location: Kelly is in an older condo that has the following areas: {kitchen, bedroom, dining, porch, office, bathroom, living room, hallway}.
Currently: Kelly is a teacher during the school year. She teaches at the school but works on lesson plans at home. She is currently living alone in a single bedroom condo.
Daily plan requirement: Kelly is planning to teach during the morning and work from home in the afternoon.s

Today is Saturday May 10. From 08:00am ~09:00am, Kelly is planning on having breakfast, from 09:00am ~ 12:00pm, Kelly is planning on working on the next day's kindergarten lesson plan, and from 12:00 ~ 13pm, Kelly is planning on taking a break.
In 5 min increments, list the subtasks Kelly does when Kelly is working on the next day's kindergarten lesson plan from 09:00am ~ 12:00pm (total duration in minutes: 180):
1) Kelly is reviewing the kindergarten curriculum standards. (duration in minutes: 15, minutes left: 165)
2) Kelly is brainstorming ideas for the lesson. (duration in minutes: 30, minutes left: 135)
3) Kelly is creating the lesson plan. (duration in minutes: 30, minutes left: 105)
4) Kelly is creating materials for the lesson. (duration in minutes: 30, minutes left: 75)
5) Kelly is taking a break. (duration in minutes: 15, minutes left: 60)
6) Kelly is reviewing the lesson plan. (duration in minutes: 30, minutes left: 30)
7) Kelly is making final changes to the lesson plan. (duration in minutes: 15, minutes left: 15)
8) Kelly is printing the lesson plan. (duration in minutes: 10, minutes left: 5)
9) Kelly is putting the lesson plan in her bag. (duration in minutes: 5, minutes left: 0)
---
Name: Isabella Rodriguez
Age: 34
Innate traits: friendly, outgoing, hospitable
Learned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.
Currently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.
Lifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Daily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Current Date: Monday February 13

Today is February 13, 2023. From 00:00AM ~ 08:00AM, Isabella Rodriguez is planning on sleeping, 08:00AM ~ 09:00AM, Isabella Rodriguez is planning on waking up and completing her morning routine, 09:00AM ~ 10:00AM, Isabella Rodriguez is planning on opening Hobbs Cafe.
In 5 min increments, list the subtasks Isabella does when Isabella is waking up and completing her morning routine from 08:00AM ~ 09:00AM (total duration in minutes 60):
1) Isabella is
TOODOOOOOO
 getting out of bed. (duration in minutes: 5, minutes left: 55)
2) Isabella is brushing her teeth. (duration in minutes: 5, minutes left: 50)
3) Isabella is taking a shower. (duration in minutes: 10, minutes left: 40)
4) Isabella is getting dressed. (duration in minutes: 10, minutes left: 30)
5) Isabella is making breakfast. (duration in minutes: 10, minutes left: 20)
6) Isabella is eating breakfast. (duration in minutes: 10, minutes left: 10)
7) Isabella is tidying up her bedroom. (duration in minutes: 5, minutes left: 5)
8) Isabella is checking her emails. (duration in minutes: 5, minutes left: 0)
-==- -==- -==-
TOODOOOOOO
 getting out of bed. (duration in minutes: 5, minutes left: 55)
9) Isabella is brushing her teeth. (duration in minutes: 5, minutes left: 50)
10) Isabella is taking a shower. (duration in minutes: 10, minutes left: 40)
11) Isabella is getting dressed. (duration in minutes: 10, minutes left: 30)
12) Isabella is making breakfast. (duration in minutes: 10, minutes left: 20)
13) Isabella is eating breakfast. (duration in minutes: 10, minutes left: 10)
14) Isabella is tidying up her bedroom. (duration in minutes: 5, minutes left: 5)
15) Isabella is checking her emails. (duration in minutes: 5, minutes left: 0)
-==- -==- -==-
IMPORTANT VVV DEBUG
[['getting out of bed', 5], ['brushing her teeth', 5], ['taking a shower', 10], ['getting dressed', 10], ['making breakfast', 10], ['eating breakfast', 10], ['tidying up her bedroom', 5], ['checking her emails', 5]]
=== persona/prompt_template/v2/task_decomp_v3.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': None}

~~~ prompt_input    ----------------------------------------------
["Name: Isabella Rodriguez\nAge: 34\nInnate traits: friendly, outgoing, hospitable\nLearned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.\nCurrently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.\nLifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.\nDaily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.\nCurrent Date: Monday February 13\n", 'Today is February 13, 2023. From 00:00AM ~ 08:00AM, Isabella Rodriguez is planning on sleeping, 08:00AM ~ 09:00AM, Isabella Rodriguez is planning on waking up and completing her morning routine, 09:00AM ~ 10:00AM, Isabella Rodriguez is planning on opening Hobbs Cafe.', 'Isabella', 'Isabella', 'waking up and completing her morning routine', '08:00AM ~ 09:00AM', 60, 'Isabella']

~~~ prompt    ----------------------------------------------------
Describe subtasks in 5 min increments.
---
Name: Kelly Bronson
Age: 35
Backstory: Kelly always wanted to be a teacher, and now she teaches kindergarten. During the week, she dedicates herself to her students, but on the weekends, she likes to try out new restaurants and hang out with friends. She is very warm and friendly, and loves caring for others.
Personality: sweet, gentle, meticulous
Location: Kelly is in an older condo that has the following areas: {kitchen, bedroom, dining, porch, office, bathroom, living room, hallway}.
Currently: Kelly is a teacher during the school year. She teaches at the school but works on lesson plans at home. She is currently living alone in a single bedroom condo.
Daily plan requirement: Kelly is planning to teach during the morning and work from home in the afternoon.s

Today is Saturday May 10. From 08:00am ~09:00am, Kelly is planning on having breakfast, from 09:00am ~ 12:00pm, Kelly is planning on working on the next day's kindergarten lesson plan, and from 12:00 ~ 13pm, Kelly is planning on taking a break.
In 5 min increments, list the subtasks Kelly does when Kelly is working on the next day's kindergarten lesson plan from 09:00am ~ 12:00pm (total duration in minutes: 180):
1) Kelly is reviewing the kindergarten curriculum standards. (duration in minutes: 15, minutes left: 165)
2) Kelly is brainstorming ideas for the lesson. (duration in minutes: 30, minutes left: 135)
3) Kelly is creating the lesson plan. (duration in minutes: 30, minutes left: 105)
4) Kelly is creating materials for the lesson. (duration in minutes: 30, minutes left: 75)
5) Kelly is taking a break. (duration in minutes: 15, minutes left: 60)
6) Kelly is reviewing the lesson plan. (duration in minutes: 30, minutes left: 30)
7) Kelly is making final changes to the lesson plan. (duration in minutes: 15, minutes left: 15)
8) Kelly is printing the lesson plan. (duration in minutes: 10, minutes left: 5)
9) Kelly is putting the lesson plan in her bag. (duration in minutes: 5, minutes left: 0)
---
Name: Isabella Rodriguez
Age: 34
Innate traits: friendly, outgoing, hospitable
Learned traits: Isabella Rodriguez is a cafe owner of Hobbs Cafe who loves to make people feel welcome. She is always looking for ways to make the cafe a place where people can come to relax and enjoy themselves.
Currently: Isabella Rodriguez is planning on having a Valentine's Day party at Hobbs Cafe with her customers on February 14th, 2023 at 5pm. She is gathering party material, and is telling everyone to join the party at Hobbs Cafe on February 14th, 2023, from 5pm to 7pm.
Lifestyle: Isabella Rodriguez goes to bed around 11pm, awakes up around 6am.
Daily plan requirement: Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Current Date: Monday February 13

Today is February 13, 2023. From 00:00AM ~ 08:00AM, Isabella Rodriguez is planning on sleeping, 08:00AM ~ 09:00AM, Isabella Rodriguez is planning on waking up and completing her morning routine, 09:00AM ~ 10:00AM, Isabella Rodriguez is planning on opening Hobbs Cafe.
In 5 min increments, list the subtasks Isabella does when Isabella is waking up and completing her morning routine from 08:00AM ~ 09:00AM (total duration in minutes 60):
1) Isabella is

~~~ output    ----------------------------------------------------
[['waking up and completing her morning routine (getting out of bed)', 5], ['waking up and completing her morning routine (brushing her teeth)', 5], ['waking up and completing her morning routine (taking a shower)', 10], ['waking up and completing her morning routine (getting dressed)', 10], ['waking up and completing her morning routine (making breakfast)', 10], ['waking up and completing her morning routine (eating breakfast)', 10], ['waking up and completing her morning routine (tidying up her bedroom)', 5], ['waking up and completing her morning routine (checking her emails)', 5]]

=== END ==========================================================




DEBUG LJSDLFSKJF
['sleeping', 480]
['waking up and completing her morning routine (getting out of bed)', 5]
['waking up and completing her morning routine (brushing her teeth)', 5]
['waking up and completing her morning routine (taking a shower)', 10]
['waking up and completing her morning routine (getting dressed)', 10]
['waking up and completing her morning routine (making breakfast)', 10]
['waking up and completing her morning routine (eating breakfast)', 10]
['waking up and completing her morning routine (tidying up her bedroom)', 5]
['waking up and completing her morning routine (checking her emails)', 5]
['opening Hobbs Cafe', 60]
['working at the cafe counter', 420]
['having dinner', 60]
['watching TV', 60]
["cleaning up or preparing for the Valentine's Day party", 60]
['closing Hobbs Cafe', 60]
['watching TV', 120]
['getting ready for bed', 60]
这生成了8点到9点这60分钟，每5分钟的详细任务，DEBUG显示了以分钟为单位的日程，早上的部分已经细化，剩余的部分还没有，需要继续细化。

推理行动区域和对象
上一步生成了早上8到9点的细化任务后，并没有继续往下细化，而是开始生成行动区域和对象。比如睡觉应该在哪儿，最终推理到Agent的公寓的主卧室的床。

这个过程还是比较复杂的，因为场景是树形结构，需要一层层去让LLM去推理，这使用了几个不同的提示词模板。

第一步：找到了Isablella的公寓（模板：persona/prompt_template/v1/action_location_sector_v1.txt）
GNS FUNCTION: <generate_action_sector>
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
TOKEN LIMIT EXCEEDED
DEBUG Ryan Park's apartment ------ Isabella Rodriguez's apartment
=== persona/prompt_template/v1/action_location_sector_v1.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-002', 'max_tokens': 15, 'temperature': 0, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': None}

~~~ prompt_input    ----------------------------------------------
['Isabella Rodriguez', "Isabella Rodriguez's apartment", 'main room', 'Isabella Rodriguez', "Isabella Rodriguez's apartment", 'main room', '\nIsabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.', "Hobbs Cafe, Isabella Rodriguez's apartment, The Rose and Crown Pub, Harvey Oak Supply Store, The Willows Market and Pharmacy, Dorm for Oak Hill College, Johnson Park, Ryan Park's apartment", 'Isabella Rodriguez', 'sleeping', 'sleeping', 'Isabella Rodriguez']

~~~ prompt    ----------------------------------------------------
Task -- choose an appropriate area  from the area options for a task at hand.

Sam Kim lives in {Sam Kim's house} that has Sam Kim's room, bathroom, kitchen.
Sam Kim is currently in {Sam Kim's house} that has Sam Kim's room, bathroom, kitchen.
Area options: {Sam Kim's house, The Rose and Crown Pub, Hobbs Cafe, Oak Hill College, Johnson Park, Harvey Oak Supply Store, The Willows Market and Pharmacy}.
* Stay in the current area if the activity can be done there. Only go out if the activity needs to take place in another place.
* Must be one of the "Area options," verbatim.
For taking a walk, Sam Kim should go to the following area: {Johnson Park}
---
Jane Anderson lives in {Oak Hill College Student Dormatory} that has Jane Anderson's room.
Jane Anderson is currently in {Oak Hill College} that has a classroom, library
Area options: {Oak Hill College Student Dormatory, The Rose and Crown Pub, Hobbs Cafe, Oak Hill College, Johnson Park, Harvey Oak Supply Store, The Willows Market and Pharmacy}.
* Stay in the current area if the activity can be done there. Only go out if the activity needs to take place in another place.
* Must be one of the "Area options," verbatim.
For eating dinner, Jane Anderson should go to the following area: {Hobbs Cafe}
---
Isabella Rodriguez lives in {Isabella Rodriguez's apartment} that has main room.
Isabella Rodriguez is currently in {Isabella Rodriguez's apartment} that has main room.
Isabella Rodriguez opens Hobbs Cafe at 8am everyday, and works at the counter until 8pm, at which point she closes the cafe.
Area options: {Hobbs Cafe, Isabella Rodriguez's apartment, The Rose and Crown Pub, Harvey Oak Supply Store, The Willows Market and Pharmacy, Dorm for Oak Hill College, Johnson Park, Ryan Park's apartment}.
* Stay in the current area if the activity can be done there. Only go out if the activity needs to take place in another place.
* Must be one of the "Area options," verbatim.
Isabella Rodriguez is sleeping. For sleeping, Isabella Rodriguez should go to the following area: {

~~~ output    ----------------------------------------------------
Isabella Rodriguez's apartment

=== END ==========================================================
第二步：推理出房间（模板 /prompt_template/v1/action_location_object_vMar11.txt）
GNS FUNCTION: <generate_action_arena>
main room
=== persona/prompt_template/v1/action_location_object_vMar11.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 15, 'temperature': 0, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': None}

~~~ prompt_input    ----------------------------------------------
['Isabella Rodriguez', "Isabella Rodriguez's apartment", 'main room', 'Isabella Rodriguez', 'sleeping', 'sleeping', 'Isabella Rodriguez', "Isabella Rodriguez's apartment", 'main room']

~~~ prompt    ----------------------------------------------------
Jane Anderson is in kitchen in Jane Anderson's house.
Jane Anderson is going to Jane Anderson's house that has the following areas: {kitchen,  bedroom, bathroom}
Stay in the current area if the activity can be done there. Never go into other people's rooms unless necessary.
For cooking, Jane Anderson should go to the following area in Jane Anderson's house:
Answer: {kitchen}
---
Tom Watson is in common room in Tom Watson's apartment.
Tom Watson is going to Hobbs Cafe that has the following areas: {cafe}
Stay in the current area if the activity can be done there. Never go into other people's rooms unless necessary.
For getting coffee, Tom Watson should go to the following area in Hobbs Cafe:
Answer: {cafe}
---

Isabella Rodriguez is going to Isabella Rodriguez's apartment that has the following areas: {main room}
* Stay in the current area if the activity can be done there.
* NEVER go into other people's rooms unless necessary.
Isabella Rodriguez is sleeping. For sleeping, Isabella Rodriguez should go to the following area in Isabella Rodriguez's apartment (MUST pick one of {main room}):
Answer: {

~~~ output    ----------------------------------------------------
main room

=== END ==========================================================
第三步：推理出床（模板：persona/prompt_template/v1/action_object_v2.txt）
GNS FUNCTION: <generate_action_game_object>
=== persona/prompt_template/v1/action_object_v2.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 15, 'temperature': 0, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': None}

~~~ prompt_input    ----------------------------------------------
['sleeping', 'bed, desk, refrigerator, closet, shelf']

~~~ prompt    ----------------------------------------------------
Current activity: sleep in bed
Objects available: {bed, easel, closet, painting}
Pick ONE most relevant object from the objects available: bed
---
Current activity: painting
Objects available: {easel, closet, sink, microwave}
Pick ONE most relevant object from the objects available: easel
---
Current activity: cooking
Objects available: {stove, sink, fridge, counter}
Pick ONE most relevant object from the objects available: stove
---
Current activity: watch TV
Objects available: {couch, TV, remote, coffee table}
Pick ONE most relevant object from the objects available: TV
---
Current activity: study
Objects available: {desk, computer, chair, bookshelf}
Pick ONE most relevant object from the objects available: desk
---
Current activity: talk on the phone
Objects available: {phone, charger, bed, nightstand}
Pick ONE most relevant object from the objects available: phone
---
Current activity: sleeping
Objects available: {bed, desk, refrigerator, closet, shelf}
Pick ONE most relevant object from the objects available:

~~~ output    ----------------------------------------------------
bed

=== END ==========================================================
行为转表情符
GNS FUNCTION: <generate_action_pronunciatio>
asdhfapsh8p9hfaiafdsi;ldfj as DEBUG 4
CHAT GPT PROMPT
"""
Convert an action description to an emoji (important: use two or less emojis).

Action description: sleeping
Emoji:
"""
Output the response to the prompt above in json. The value for the output must ONLY contain the emojis.
Example output json:
{"output": "  ‍♀️"}
这个功能又分为几个步骤。

行为解析为(主语，谓语，宾语)
GNS FUNCTION: <generate_action_event_triple>
=== persona/prompt_template/v2/generate_event_triple_v1.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 30, 'temperature': 0, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': ['\n']}

~~~ prompt_input    ----------------------------------------------
['Isabella Rodriguez', 'sleeping', 'Isabella Rodriguez']

~~~ prompt    ----------------------------------------------------
Task: Turn the input into (subject, predicate, object).

Input: Sam Johnson is eating breakfast.
Output: (Dolores Murphy, eat, breakfast)
---
Input: Joon Park is brewing coffee.
Output: (Joon Park, brew, coffee)
---
Input: Jane Cook is sleeping.
Output: (Jane Cook, is, sleep)
---
Input: Michael Bernstein is writing email on a computer.
Output: (Michael Bernstein, write, email)
---
Input: Percy Liang is teaching students in a classroom.
Output: (Percy Liang, teach, students)
---
Input: Merrie Morris is running on a treadmill.
Output: (Merrie Morris, run, treadmill)
---
Input: Isabella Rodriguez is sleeping.
Output: (Isabella Rodriguez,

~~~ output    ----------------------------------------------------
('Isabella Rodriguez', 'is', 'sleep')

=== END ==========================================================
生成行为所操作的物体的描述
GNS FUNCTION: <generate_act_obj_desc>
asdhfapsh8p9hfaiafdsi;ldfj as DEBUG 6
CHAT GPT PROMPT
"""
Task: We want to understand the state of an object that is being used by someone.

Let's think step by step.
We want to know about bed's state.
Step 1. Isabella Rodriguez is at/using the sleeping.
Step 2. Describe the bed's state: bed is
"""
Output the response to the prompt above in json. The output should ONLY contain the phrase that should go in <fill in>.
Example output json:
{"output": "being fixed"}
描述转表情符
GNS FUNCTION: <generate_action_pronunciatio>
asdhfapsh8p9hfaiafdsi;ldfj as DEBUG 4
CHAT GPT PROMPT
"""
Convert an action description to an emoji (important: use two or less emojis).

Action description: being used
Emoji:
"""
Output the response to the prompt above in json. The value for the output must ONLY contain the emojis.
Example output json:
{"output": "  ‍♀️"}
生成被操作的物体的主谓宾三元组
这个和上面生成人物行为的主谓宾三元组很像，估计是用来改变物体的状态

GNS FUNCTION: <generate_act_obj_event_triple>
=== persona/prompt_template/v2/generate_event_triple_v1.txt
~~~ persona    ---------------------------------------------------
Isabella Rodriguez

~~~ gpt_param ----------------------------------------------------
{'engine': 'text-davinci-003', 'max_tokens': 30, 'temperature': 0, 'top_p': 1, 'stream': False, 'frequency_penalty': 0, 'presence_penalty': 0, 'stop': ['\n']}

~~~ prompt_input    ----------------------------------------------
['bed', 'being used', 'bed']

~~~ prompt    ----------------------------------------------------
Task: Turn the input into (subject, predicate, object).

Input: Sam Johnson is eating breakfast.
Output: (Dolores Murphy, eat, breakfast)
---
Input: Joon Park is brewing coffee.
Output: (Joon Park, brew, coffee)
---
Input: Jane Cook is sleeping.
Output: (Jane Cook, is, sleep)
---
Input: Michael Bernstein is writing email on a computer.
Output: (Michael Bernstein, write, email)
---
Input: Percy Liang is teaching students in a classroom.
Output: (Percy Liang, teach, students)
---
Input: Merrie Morris is running on a treadmill.
Output: (Merrie Morris, run, treadmill)
---
Input: bed is being used.
Output: (bed,

~~~ output    ----------------------------------------------------
('bed', 'be', 'used')

=== END ==========================================================
以上，本次模拟的3个角色之一的Isabella Rodriguez的早上8点的详细计划以及当前的行为（睡觉）的描述都完成了。下面的log是其他两个角色的相似的功能，略过。

小结
这100秒的模拟，仅仅让3个角色完成了从计划起床时间，到日计划，到小时计划，到8点的详细计划，以及当前行为（睡觉）的地点和物品查找和描述。LLM调用的次数还是比较多的，成本也不低啊。后续可能在成本允许的情况下，继续模拟一下看看。


送礼物
还没有人送礼物，鼓励一下作者吧
所属专栏 · 2023-09-14 18:35 更新

LLM + Agent + Game

真趣
7 篇内容 · 650 赞同
订阅
最热内容 ·
斯坦福AI小镇论文解读-生成代理:人类行为的交互模拟
编辑于 2023-08-14 20:10・北京
斯坦福大学 (Stanford University)
学习分析learning analytics
人工智能
​赞同 491​
​50 条评论
​分享
​喜欢
​收藏
​申请转载
​

理性发言，友善互动

50 条评论
默认
最新
亚东
亚东
知乎知识会员
你这个选的模型有问题： 'text-davinci-003' 的价钱应该是$0.0200 / 1K tokens, 而 GPT-3.5 16K 才 $0.004 / 1K tokens
价钱差了有 25 倍

2023-08-11 · 美国
​回复
​3
永远不会放弃你
永远不会放弃你
有可能直接照搬今年早些时候斯坦福写的代码，那个时候还在用davinci
2023-08-11 · 重庆
​回复
​1
亚东
亚东
知乎知识会员
永远不会放弃你
我不清楚 gpt4 要不要开通 plus 会员，但在基础效果上应该没有区别吧。
2023-08-11 · 浙江
​回复
​喜欢
查看全部 8 条回复​
Rechaos
Rechaos
昨天看到这个开源了 想试试能不能用国产模型替代 最终想加载MUD游戏进去试试
2023-08-11 · 陕西
​回复
​4
真趣
真趣
作者
今天打算找个开源的部署一下试试
2023-08-11 · 北京
​回复
​1
爱你
爱你
你做了么 可以交流一下啊

2023-11-09 · 北京
​回复
​喜欢
StephenZhu
StephenZhu
搞这个的目的是？
2023-08-11 · 山东
​回复
​3
林仔
林仔
对小镇的人来说，可能是创世纪[惊喜]
2023-08-11 · 上海
​回复
​40
taotao
taotao
以后做游戏可以省去一部分写对白的时间

2023-09-20 · 广东
​回复
​2
Crossin
Crossin
​
知乎知识会员
gpt-3.5-turbo效果比text-davinci-003有显著提升，且便宜10倍
2023-08-13 · 江苏
​回复
​1
马啵
马啵
看了代码感觉冗余的太多了
2023-08-11 · 浙江
​回复
​2
涂子
涂子
​
知乎知识会员
斯坦福小镇设计目的是学术研究，当然是应算尽算，代码水平也是其次。主要是展现AI数字居民的可行性。
2023-08-13 · 上海
​回复
​9
肥肥
肥肥
openai.error.APIConnectionError: Error communicating with OpenAI: HTTPSConnectionPool(host='api.openai.com', port=443): Max retries exceeded run 10模拟出错了，免费的openAI跑不了嘛亲？

2023-08-11 · 日本
​回复
​1
真趣
真趣
作者
先确认你的key还能用，再确认网络，看你IP网络应该可以

2023-08-11 · 北京
​回复
​3
肥肥
肥肥
真趣
好的谢谢我知道问题了，因为网络问题必须要 openai.api_base指定代理服务器才行

2023-08-11 · 上海
​回复
​1
展开其他 1 条回复​
柳杨
柳杨
很好奇这个游戏是怎么运行的，插眼求更新
2023-08-11 · 河北
​回复
​1
没头脑和不高兴
没头脑和不高兴
游戏本身是基于phaser这个H5游戏引擎，就正常的通过tile构建地图，然后controller控制npc的位置，只是这个controller交由AI进行控制了

2023-09-01 · 广东
​回复
​5
醉逍遥
醉逍遥
大大您好我也遇到了list index out of range这个报错，但是我是在run 1时就遇到了，不知道是什么问题[大哭]

2024-05-31 · 美国
​回复
​喜欢
花生了什么树
花生了什么树
请问解决了嘛，我也有这个问题[大哭]

03-06 · 湖南
​回复
​喜欢
xxx
xxx
为什么我跑的时候出现TOKEN LIMITED EXCEEDED的问题呀

2024-05-25 · 北京
​回复
​喜欢
爱你
爱你
我问下做的实时进行的demo怎么做啊

2023-12-28 · 北京
​回复
​喜欢
点击查看全部评论

理性发言，友善互动

关于作者
真趣
真趣
回答
29
文章
12
关注者
3,699
​关注他
​发私信
推荐阅读
斯坦福小镇核心代码解读
斯坦福小镇核心代码解读
小小马
机器人版的「斯坦福小镇」来了，专为具身智能研究打造
机器之心报道， 编辑：张倩。还记得斯坦福的 AI 小镇吗？这是斯坦福的 AI 研究者打造的一个虚拟环境。在这个小镇上，25 个 AI 智能体正常生活、工作、社交，甚至谈恋爱，每个智能体都有自己…

机器之心
发表于机器之心
硅基流动凭什么能被小镇 AI 家爱上
硅基流动凭什么能被小镇 AI 家爱上
七月正当夏
2024年人工智能现状报告（二）
2024年人工智能现状报告（二）
数据与AI爱好者


选择语言
选择语言
